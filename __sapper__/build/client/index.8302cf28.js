import{S as e,i as s,s as n,e as a,l as t,a as c,b as r,m as o,d as l,f as i,g as m,o as u,p as h,B as d,q as f,C as g,D as v,v as y,t as p,k as U,A as C,x as E,E as $,F as k,G as T,H as w,z as b}from"./chunk.6d350191.js";import{H as D,i as S,f as j}from"./chunk.29ec06c7.js";const{document:A}=T;function B(e,s,n){const a=Object.create(e);return a.message=s[n],a}function I(e){var s,n,f,g,v=e.message;return{c(){s=a("li"),n=t(v),this.h()},l(e){s=c(e,"LI",{class:!0},!1);var a=r(s);n=o(a,v),a.forEach(l),this.h()},h(){i(s,"class","svelte-y27m3y")},m(e,a){m(e,s,a),u(s,n),g=!0},p(e,s){g&&!e.messages||v===(v=s.message)||h(n,v)},i(e){g||(w(()=>{f||(f=d(s,j,{},!0)),f.run(1)}),g=!0)},o(e){f||(f=d(s,j,{},!1)),f.run(0),g=!1},d(e){e&&(l(s),f&&f.end())}}}function _(e){for(var s,n,d,T,w,S,j,_,O,H,F,L,M,N,P,V,W,Y,q,z,G,R,J,K,Q=1==e.numUsersConnected?"is":"are",X=1==e.numUsersConnected?"user":"users",Z=new D({props:{text:"Chat App"}}),ee=e.messages,se=[],ne=0;ne<ee.length;ne+=1)se[ne]=I(B(e,ee,ne));const ae=e=>U(se[e],1,1,()=>{se[e]=null});return{c(){s=a("meta"),n=f(),d=a("body"),T=a("div"),Z.$$.fragment.c(),w=f(),S=a("div"),j=a("ul");for(var c=0;c<se.length;c+=1)se[c].c();_=f(),O=a("form"),H=a("input"),F=f(),L=a("button"),M=t("Send"),N=f(),P=a("p"),V=t("There "),W=t(Q),Y=f(),q=t(e.numUsersConnected),z=f(),G=t(X),R=t(" currently chatting!"),this.h()},l(a){s=c(a,"META",{name:!0,content:!0,class:!0},!1),r(s).forEach(l),n=o(a,"\n\n\n\n\n\n"),d=c(a,"BODY",{class:!0},!1);var t=r(d);T=c(t,"DIV",{class:!0},!1);var i=r(T);Z.$$.fragment.l(i),w=o(i,"\n    "),S=c(i,"DIV",{id:!0,class:!0},!1);var m=r(S);j=c(m,"UL",{id:!0,class:!0},!1);for(var u=r(j),h=0;h<se.length;h+=1)se[h].l(u);u.forEach(l),m.forEach(l),_=o(i,"\n    "),O=c(i,"FORM",{action:!0,class:!0},!1);var f=r(O);H=c(f,"INPUT",{id:!0,autocomplete:!0,placeholder:!0,class:!0},!1),r(H).forEach(l),F=o(f,"\n      "),L=c(f,"BUTTON",{class:!0},!1);var g=r(L);M=o(g,"Send"),g.forEach(l),f.forEach(l),N=o(i,"\n\t\t"),P=c(i,"P",{id:!0,class:!0},!1);var v=r(P);V=o(v,"There "),W=o(v,Q),Y=o(v," "),q=o(v,e.numUsersConnected),z=o(v," "),G=o(v,X),R=o(v," currently chatting!"),v.forEach(l),i.forEach(l),t.forEach(l),this.h()},h(){A.title="Chat App",i(s,"name","viewport"),i(s,"content","width=device-width, initial-scale=1.0"),i(s,"class","svelte-y27m3y"),i(j,"id","messages"),i(j,"class","svelte-y27m3y"),i(S,"id","chatWindow"),i(S,"class","svelte-y27m3y"),i(H,"id","m"),i(H,"autocomplete","off"),i(H,"placeholder",x),i(H,"class","svelte-y27m3y"),i(L,"class","svelte-y27m3y"),i(O,"action",""),i(O,"class","svelte-y27m3y"),i(P,"id","numUsers"),i(P,"class","svelte-y27m3y"),i(T,"class","main svelte-y27m3y"),i(d,"class","svelte-y27m3y"),K=[g(window,"unload",e.emitUserDisconnect),g(H,"input",e.input_input_handler),g(L,"click",v(e.handleSubmit))]},m(a,t){u(A.head,s),m(a,n,t),m(a,d,t),u(d,T),y(Z,T,null),u(T,w),u(T,S),u(S,j);for(var c=0;c<se.length;c+=1)se[c].m(j,null);u(T,_),u(T,O),u(O,H),H.value=e.message,u(O,F),u(O,L),u(L,M),u(T,N),u(T,P),u(P,V),u(P,W),u(P,Y),u(P,q),u(P,z),u(P,G),u(P,R),J=!0},p(e,s){if(e.messages){ee=s.messages;for(var n=0;n<ee.length;n+=1){const a=B(s,ee,n);se[n]?(se[n].p(e,a),p(se[n],1)):(se[n]=I(a),se[n].c(),p(se[n],1),se[n].m(j,null))}for(b(),n=ee.length;n<se.length;n+=1)ae(n);C()}e.message&&H.value!==s.message&&(H.value=s.message),J&&!e.numUsersConnected||Q===(Q=1==s.numUsersConnected?"is":"are")||h(W,Q),J&&!e.numUsersConnected||h(q,s.numUsersConnected),J&&!e.numUsersConnected||X===(X=1==s.numUsersConnected?"user":"users")||h(G,X)},i(e){if(!J){p(Z.$$.fragment,e);for(var s=0;s<ee.length;s+=1)p(se[s]);J=!0}},o(e){U(Z.$$.fragment,e),se=se.filter(Boolean);for(let e=0;e<se.length;e+=1)U(se[e]);J=!1},d(e){l(s),e&&(l(n),l(d)),E(Z),$(se,e),k(K)}}}const x="Type your message here...";function O(){const e=document.getElementById("chatWindow");setTimeout(()=>{e.scrollTop=e.scrollHeight},0)}function H(e,s,n){const a=S();let t=["You have joined the chat. Use '/nick your_nickname' to set your nickname!"],c="",r="Anonymous",o=0;return a.on("message",function(e){n("messages",t=t.concat(e)),O()}),a.on("user joined",function({message:e,numUsers:s}){n("messages",t=t.concat(e)),n("numUsersConnected",o=s),O()}),a.on("user left",function(e){n("numUsersConnected",o=e),O()}),{messages:t,message:c,numUsersConnected:o,emitUserDisconnect:function(){a.emit("user disconnect",r)},handleSubmit:function(){if(n("message",c=c.trim()),""==c)return;let e=`${r}: ${c}`;if("/nick"==c.slice(0,5)){let s=c.slice(6);e=`Server: ${r} changed their nickname to ${s}`,r=s}n("messages",t=t.concat(e)),a.emit("message",e),O(),n("message",c="")},input_input_handler:function(){c=this.value,n("message",c)}}}export default class extends e{constructor(e){super(),s(this,e,H,_,n,[])}}
//# sourceMappingURL=index.8302cf28.js.map
